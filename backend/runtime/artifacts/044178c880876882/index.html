<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Road Racer</title>
    <style>
        body {
            margin: 0;
            padding: 20px;
            background: #222;
            display: flex;
            flex-direction: column;
            align-items: center;
            color: white;
            font-family: Arial, sans-serif;
        }
        canvas {
            border: 2px solid #fff;
            background: #333;
        }
        .game-info {
            margin: 10px 0;
            display: flex;
            gap: 20px;
        }
        .controls {
            margin-top: 10px;
            color: #ccc;
        }
    </style>
</head>
<body>
    <h1>ROAD RACER</h1>
    <div class="game-info">
        <div>Score: <span id="score">0</span></div>
        <div>Health: <span id="health">100</span></div>
    </div>
    <canvas id="gameCanvas" width="800" height="600"></canvas>
    <div class="controls">Controls: Arrow Keys to move, Space to attack</div>

    <script>
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        const scoreElement = document.getElementById('score');
        const healthElement = document.getElementById('health');

        // Game state
        let score = 0;
        let health = 100;
        let gameOver = false;

        // Player bike
        const player = {
            x: canvas.width / 2,
            y: canvas.height - 100,
            width: 40,
            height: 60,
            speed: 5,
            attackCooldown: 0
        };

        // Opponents array
        let opponents = [];
        let roadLines = [];

        // Initialize road lines
        for (let i = -20; i < canvas.height; i += 40) {
            roadLines.push(i);
        }

        // Create new opponent
        function createOpponent() {
            opponents.push({
                x: Math.random() * (canvas.width - 60) + 30,
                y: -60,
                width: 40,
                height: 60,
                speed: 3 + Math.random() * 2,
                health: 3
            });
        }

        // Draw functions
        function drawPlayer() {
            ctx.fillStyle = '#ff4444';
            ctx.fillRect(player.x - player.width/2, player.y - player.height/2, player.width, player.height);
            
            // Draw wheels
            ctx.fillStyle = '#333';
            ctx.fillRect(player.x - player.width/2 - 5, player.y - player.height/2 + 10, 5, 15);
            ctx.fillRect(player.x + player.width/2, player.y - player.height/2 + 10, 5, 15);
            ctx.fillRect(player.x - player.width/2 - 5, player.y + player.height/2 - 25, 5, 15);
            ctx.fillRect(player.x + player.width/2, player.y + player.height/2 - 25, 5, 15);
        }

        function drawOpponent(opponent) {
            ctx.fillStyle = '#4444ff';
            ctx.fillRect(opponent.x - opponent.width/2, opponent.y - opponent.height/2, opponent.width, opponent.height);
            
            // Draw wheels
            ctx.fillStyle = '#333';
            ctx.fillRect(opponent.x - opponent.width/2 - 5, opponent.y - opponent.height/2 + 10, 5, 15);
            ctx.fillRect(opponent.x + opponent.width/2, opponent.y - opponent.height/2 + 10, 5, 15);
            ctx.fillRect(opponent.x - opponent.width/2 - 5, opponent.y + opponent.height/2 - 25, 5, 15);
            ctx.fillRect(opponent.x + opponent.width/2, opponent.y + opponent.height/2 - 25, 5, 15);
        }

        function drawRoad() {
            // Road
            ctx.fillStyle = '#555';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            // Road lines
            ctx.fillStyle = '#fff';
            roadLines.forEach(line => {
                ctx.fillRect(canvas.width/2 - 2, line, 4, 20);
            });
        }

        // Update functions
        function update() {
            if (gameOver) return;
            
            // Move road lines
            roadLines = roadLines.map(line => {
                line += 5;
                if (line > canvas.height) line = -20;
                return line;
            });
            
            // Update player attack cooldown
            if (player.attackCooldown > 0) {
                player.attackCooldown--;
            }
            
            // Update opponents
            opponents.forEach((opponent, index) => {
                opponent.y += opponent.speed;
                
                // Check collision with player
                if (Math.abs(opponent.x - player.x) < (player.width + opponent.width)/2 &&
                    Math.abs(opponent.y - player.y) < (player.height + opponent.height)/2) {
                    health -= 10;
                    healthElement.textContent = health;
                    opponents.splice(index, 1);
                    
                    if (health <= 0) {
                        gameOver = true;
                    }
                }
                
                // Remove opponents that go off screen
                if (opponent.y > canvas.height + 100) {
                    opponents.splice(index, 1);
                    score += 10;
                    scoreElement.textContent = score;
                }
            });
            
            // Spawn new opponents
            if (Math.random() < 0.02) {
                createOpponent();
            }
        }

        // Draw game
        function draw() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            drawRoad();
            drawPlayer();
            opponents.forEach(drawOpponent);
            
            if (gameOver) {
                ctx.fillStyle = 'rgba(0, 0, 0, 0.7)';
                ctx.fillRect(0, 0, canvas.width, canvas.height);
                ctx.fillStyle = '#fff';
                ctx.font = '48px Arial';
                ctx.textAlign = 'center';
                ctx.fillText('GAME OVER', canvas.width/2, canvas.height/2);
                ctx.font = '24px Arial';
                ctx.fillText('Final Score: ' + score, canvas.width/2, canvas.height/2 + 50);
            }
        }

        // Game loop
        function gameLoop() {
            update();
            draw();
            requestAnimationFrame(gameLoop);
        }

        // Input handling
        document.addEventListener('keydown', (e) => {
            if (gameOver) return;
            
            switch(e.key) {
                case 'ArrowLeft':
                    player.x = Math.max(player.width/2, player.x - player.speed);
                    break;
                case 'ArrowRight':
                    player.x = Math.min(canvas.width - player.width/2, player.x + player.speed);
                    break;
                case 'ArrowUp':
                    player.y = Math.max(player.height/2, player.y - player.speed);
                    break;
                case 'ArrowDown':
                    player.y = Math.min(canvas.height - player.height/2, player.y + player.speed);
                    break;
                case ' ':
                    if (player.attackCooldown === 0) {
                        attack();
                        player.attackCooldown = 30;
                    }
                    break;
            }
        });

        // Attack function
        function attack() {
            opponents.forEach((opponent, index) => {
                if (Math.abs(opponent.x - player.x) < 100 &&
                    Math.abs(opponent.y - player.y) < 100) {
                    opponent.health--;
                    if (opponent.health <= 0) {
                        opponents.splice(index, 1);
                        score += 20;
                        scoreElement.textContent = score;
                    }
                }
            });
        }

        // Start game
        gameLoop();
    </script>

<script>
try{
  window.addEventListener('message', function(e){
    if(e && e.data === 'surfers:reload'){ location.reload(); }
  });
  if (window.parent) {
    window.parent.postMessage({type:'surfers:ready'}, '*');
  }
  window.addEventListener('error', function(e){
    try { window.parent && window.parent.postMessage({type:'surfers:error', msg: String(e.error||e.message) }, '*'); } catch(e){}
  });
} catch(e){}
</script>
</body>
</html>